define("user:widget/address_form/address_form.js",function(e,t,s){var a=e("common:widget/ui/dialog/dialog.js");s.exports={init:function(){var e=this;e.bindEvents(),e.checkAddressInfo(),F.checkAddressInfoForSubmit=function(){return function(){return e.checkAddressInfoForSubmit()}}(),F.getAddressParams=function(){return function(){return e.getAddressParams()}}()},bindEvents:function(){var e=this;e.renderProvince(),$("#province").change(function(){e.renderCity()}),$("#city").change(function(){e.renderDistrict()}),$("#j-searchPostCode").hover(function(){e.changeSelectPostUrl()})},checkAddressInfo:function(){var e={empty:/^\s*$/,name:/^[\sA-Za-z0-9\-\u4E00-\u9FA5]{2,15}$/,mobile:/^1\d{10}$/,tel:/^[1-9]\d{6,7}$/,postCode:/^[0-9]\d{5}(?!\d)$/},t={emptyProvince:"您还没有选择您所在的省份",emptyCity:"您还没有选择您所在的城市",emptyDistrict:"您还没有选择您所在的区域",emptyStreet:"您还没有填写街道地址",emptyPostcode:"您还没有填写邮政编码",emptyName:"您还没有填写收货人姓名",emptyPhone:"您还没有填写手机号码",checkStreet:"街道地址不少于5个字，不多于60个字",checkPostcode:"请填写正确邮政编码",checkName:"收货人姓名不少于2个字，不多于15个字",checkPhone:"请正确填写手机号码",checkTel:"请正确填写电话号码"};$("#province").blur(function(){"省份"==$("#province option:selected").text()?($("#area-msg").html(t.emptyProvince),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide")):$("#area-msg").addClass("msg-hide")}),$("#city").blur(function(){return"城市"==$("#city option:selected").text()?($("#area-msg").html(t.emptyCity),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),!1):void($("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide"))}),$("#district").blur(function(){"区域"==$("#district option:selected").text()?($("#area-msg").html(t.emptyDistrict),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide")):$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide")}),$("#street").blur(function(){var s=$.trim($("#street").val());e.empty.test(s)?($("#street-msg").html(t.emptyStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide")):s.length<5||s.length>60?($("#street-msg").html(t.checkStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide")):$("#street-msg").addClass("msg-hide")}),$("#post-code").blur(function(){var s=$.trim($("#post-code").val());e.empty.test(s)?($("#postcode-msg").html(t.emptyPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide")):e.postCode.test(s)?$("#postcode-msg").addClass("msg-hide"):($("#postcode-msg").html(t.checkPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide"))}),$("#name").blur(function(){var s=$.trim($("#name").val());e.empty.test(s)?($("#name-msg").html(t.emptyName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide")):e.name.test(s)?$("#name-msg").addClass("msg-hide"):($("#name-msg").html(t.checkName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide"))}),$("#phone").blur(function(){var s=$.trim($("#phone").val());e.empty.test(s)?($("#phone-msg").html(t.emptyPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide")):e.mobile.test(s)?$("#phone-msg").addClass("msg-hide"):($("#phone-msg").html(t.checkPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide"))}),$("#tel").blur(function(){var s=$.trim($("#tel").val());e.empty.test(s)||e.tel.test(s)?$("#tel-msg").addClass("msg-hide"):($("#tel-msg").html(t.checkTel),$("#tel-msg").hasClass("msg-hide")&&$("#tel-msg").removeClass("msg-hide"))})},checkAddressInfoForSubmit:function(){var e={empty:/^\s*$/,name:/^[\sA-Za-z0-9\-\u4E00-\u9FA5]{2,15}$/,mobile:/^1\d{10}$/,tel:/^[1-9]\d{6,7}$/,postCode:/^[0-9]\d{5}(?!\d)$/},t={emptyProvince:"您还没有选择您所在的省份",emptyCity:"您还没有选择您所在的城市",emptyDistrict:"您还没有选择您所在的区域",emptyStreet:"您还没有填写街道地址",emptyPostcode:"您还没有填写邮政编码",emptyName:"您还没有填写收货人姓名",emptyPhone:"您还没有填写手机号码",checkStreet:"街道地址不少于5个字，不多于60个字",checkPostcode:"请填写正确邮政编码",checkName:"收货人姓名不少于2个字，不多于15个字",checkPhone:"请正确填写手机号码",checkTel:"请正确填写电话号码"},s=!0;"省份"==$("#province option:selected").text()?($("#area-msg").html(t.emptyProvince),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),s=!1):$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide"),"城市"==$("#city option:selected").text()?($("#area-msg").html(t.emptyCity),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),s=!1):$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide"),"区域"==$("#district option:selected").text()?($("#area-msg").html(t.emptyDistrict),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),s=!1):$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide");var a=$.trim($("#street").val());e.empty.test(a)?($("#street-msg").html(t.emptyStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide"),s=!1):a.length<5||a.length>60?($("#street-msg").html(t.checkStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide"),s=!1):$("#street-msg").addClass("msg-hide");var d=$.trim($("#post-code").val());e.empty.test(d)?($("#postcode-msg").html(t.emptyPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide"),s=!1):e.postCode.test(d)?$("#postcode-msg").addClass("msg-hide"):($("#postcode-msg").html(t.checkPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide"),s=!1);var i=$.trim($("#name").val());e.empty.test(i)?($("#name-msg").html(t.emptyName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide"),s=!1):e.name.test(i)?$("#name-msg").addClass("msg-hide"):($("#name-msg").html(t.checkName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide"),s=!1);var o=$.trim($("#phone").val());e.empty.test(o)?($("#phone-msg").html(t.emptyPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide"),s=!1):e.mobile.test(o)?$("#phone-msg").addClass("msg-hide"):($("#phone-msg").html(t.checkPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide"),s=!1);var r=$.trim($("#tel").val());return e.empty.test(r)||e.tel.test(r)?$("#tel-msg").addClass("msg-hide"):($("#tel-msg").html(t.checkTel),$("#tel-msg").hasClass("msg-hide")&&$("#tel-msg").removeClass("msg-hide"),s=!1),s},getAddressParams:function(){var e={};return e.area_id=0!=$("#district option:selected").val()?$("#district option:selected").val():$("#city option:selected").val(),e.address=$("#province option:selected").text()+" "+$("#city option:selected").text()+" "+$("#district option:selected").text()+" "+$.trim($("#street").val()),e.post_code=$.trim($("#post-code").val()),e.name=$.trim($("#name").val()),e.phone=$.trim($("#phone").val()),e.telephone_district=$.trim($("#tel-district").val()),e.telephone=$.trim($("#tel").val()),e.telephone_ext=$.trim($("#tel-ext").val()),e.is_default=$("#j-isDefault").prop("checked")?"1":"0",e},modifyAddress:function(e){$.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{action:"modc",id:e.id,area_id:e.areaId},success:function(t){if(0==t.errno){var s=t.data,d=$("#J-add-address");d.hasClass("J-modify-address")||d.addClass("J-modify-address"),d.hasClass("add-address-active")||d.addClass("add-address-active"),$("#J-add-address .add-address-btn").find("a").html("修改地址"),$("#J-add-address .w-add-address-form li.msg").addClass("msg-hide"),$("#J-save-address").attr("data-id",e.id),d.find(".add-address-form").hasClass("msg-hide")&&d.find(".add-address-form").removeClass("msg-hide");var i,o,r,m=0,n=0,c=0,l="<option value='0'>省份</option>";$.each(s.provs,function(e,t){return l+="<option value='"+t.area_code+"'>"+t.name+"</option>",m+=1,t.area_code==s.curaddr.area_id.substring(0,6)?i=m:void 0}),$("#province").html(l),0!=i?$("#province").find("option").eq(i).attr("selected",!0):($("#province").find("option").eq(0).attr("selected",!0),$("#province").attr("disabled",!0));var h="<option value='0'>城市</option>";$.each(s.cits,function(e){h+="<option value='"+s.cits[e].area_code+"'>"+s.cits[e].name+"</option>",n+=1,s.cits[e].area_code==s.curaddr.area_id.substring(0,9)&&(o=n)}),$("#city").html(h),0!=o?($("#city").find("option").eq(o).attr("selected",!0),$("#city").attr("disabled",!1)):($("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0));var p="<option value='0'>区域</option>";$.each(s.counts,function(e){p+="<option value='"+s.counts[e].area_code+"'>"+s.counts[e].name+"</option>",c+=1,s.counts[e].area_code==s.curaddr.area_id&&(r=c)}),$("#district").html(p),0!=r?($("#district").find("option").eq(r).attr("selected",!0),$("#district").attr("disabled",!1)):($("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)),$("#is-default").val(s.curaddr.is_default),$("#street").val(s.curaddr.address),$("#post-code").val(s.curaddr.post_code),$("#name").val(s.curaddr.name),$("#phone").val(s.curaddr.phone),$("#tel-district").val(s.curaddr.telephone_district),$("#tel").val(s.curaddr.telephone),$("#tel-ext").val(s.curaddr.telephone_ext)}else{var g=t.errmsg,u=a.alert({width:400,title:"错误提示",content:g,customClassName:"ui-alert-address",mask:{enable:!0,opacity:.25}});u.center()}}})},modifyDefaultAddress:function(e){e.target.parents("tr").addClass("default-address").siblings().removeClass("default-address"),$.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{action:"setd",id:e.id}})},renderProvince:function(){$.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{action:"getp"},success:function(e){if(""==e.errno){var t="<option value='0'>省份</option>",s=e.data;$.each(s,function(e){t+="<option value='"+s[e].area_code+"'>"+s[e].name+"</option>"}),$("#province").html(t),$("#province").find("option").eq(0).attr("selected",!0),$("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)}else{var d=e.errmsg,i=a.alert({width:400,title:"错误提示",content:d,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});i.center()}}})},renderCity:function(){var e=$("#province option:selected").val();return 0==e?($("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0),!1):($("#city").attr("disabled",!1),void $.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{pid:e,action:"getcp"},success:function(e){if(""==e.errno){var t="<option value='0'>城市</option>",s=e.data;$.each(s,function(e){t+="<option value='"+s[e].area_code+"'>"+s[e].name+"</option>"}),$("#city").html(t),$("#city").find("option").eq(0).attr("selected",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)}else{var d=e.errmsg,i=a.alert({width:400,title:"错误提示",content:d,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});i.center()}}}))},renderDistrict:function(){var e=$("#city option:selected").val();return 0==e?($("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0),!1):($("#district").attr("disabled",!1),void $.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{cid:e,action:"getcc"},success:function(e){if(""==e.errno){var t="<option value='0'>区域</option>",s=e.data;$.each(s,function(e){t+="<option value='"+s[e].area_code+"'>"+s[e].name+"</option>"}),$("#district").html(t),$("#district").find("option").eq(0).attr("selected",!0)}else{var d=e.errmsg,i=a.alert({width:400,title:"错误提示",content:d,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});i.center()}}}))},changeSelectPostUrl:function(){var e="http://opendata.baidu.com/post/s",t="";"省份"!=$("#province option:selected").text()&&(t+=encodeURIComponent($("#province option:selected").text())),"城市"!=$("#city option:selected").text()&&$("#province option:selected").text().indexOf($("#city option:selected").text())<0&&(t+=encodeURIComponent($("#city option:selected").text())),"区域"!=$("#district option:selected").text()&&(t+=encodeURIComponent($("#district option:selected").text())),""!=$("#street").val()&&(t+=encodeURIComponent($("#street").val())),e=e+"?wd="+t+"&rn=20&ie=utf-8",$("#j-searchPostCode").attr("href",e)}}});
;define("user:widget/balance/balance_list/card_exchange.js",function(a,e,n){function c(){var a=l.val();a&&a.length?u.addClass("card-code-fill"):u.removeClass("card-code-fill")}function o(){l.val(""),u.removeClass("card-code-fill")}function t(){var a=function(){},e=function(){window.location.reload()},n={width:400,title:"提示",content:"我去，这是什么？？？？？",customClassName:"ui-alert-uc card-charge-dlg",timeout:5e3,mask:{enable:!0,zIndex:100,opacity:.3,backgroundColor:"#000"},onhide:a,mask:{enable:!0,opacity:.25}},c=l.val();if(c&&c.length){var t=$.ajax({url:d,type:"POST",dataType:"json",data:{code:c}});t.then(function(c){0===c.errno?(n.onhide=e,n.content="<p>充值成功</p><p>由于系统缓存原因请在20秒后刷新页面查看最新余额</p>",o()):(n.onhide=a,n.content=c.msg),i.splash(n)})}}var i=a("common:widget/ui/dialog/dialog.js"),d="/uc/hongbao/cardexchange",l=$("#card-exchange-code"),r=$("#card-exchange-submit"),s=$("#card-cord-del"),u=$("#my-balance .n-card-exchange");n.exports={init:function(){l.on("input",c),s.on("click",o),r.on("click",t)}}});
;define("user:widget/comment/comment_wrap.js",function(t,e,a){var r=t("common:widget/ui/comment/comment.js");a.exports={bindEvents:function(){$("#J-comment").click(function(t){var e=t.target||t.srcElement,a=$(e),d=a.attr("data-target");if(d){var c={};c.id=a.attr("order-id"),c.dealId=a.attr("deal-id"),c.catgIds=a.attr("data-catg"),c.score=a.attr("score")||0,"publish-comment"==d||"publish-comment-star"==d?r.init({orderId:c.id,dealId:c.dealId,catg_ids:c.catgIds,score:c.score}):"edit-comment"==d&&r.init({orderId:c.id,dealId:c.dealId,catg_ids:c.catgIds})}}),$("#J-comment").mouseover(function(t){var e=t.target||t.srcElement,a=$(e),r=a.attr("data-target");if(r){var d={};if(d.id=a.attr("order-id"),d.dealId=a.attr("deal-id"),d.score=a.attr("score")||0,"publish-comment-star"==r){var c=18*d.score;a.parents(".ugc-star-wrap-uc").find(".ugc-star").width(c)}}})}}});
;define("user:widget/my_account/account_info/account_info.js",function(e){var n=e("common:widget/ui/voice_check/voice_check.js");$(function(){var e=F.context("antiCheatPassuid"),t=new n({type:0,passuid:e,avaiBtn:"j-available-user-center",disableBut:"j-disable-user-center",waitingBut:"j-waiting-user-center",verifyCodeInput:"j-verify-input-user-center",verifyNow:"j-verify-btn-user-center",errMsg:"j-error-msg-user-center"});t.handleAntiCheatUserCenter()})});
;define("user:widget/my_account/address/address.js",function(e,t,s){var a=e("common:widget/ui/dialog/dialog.js");s.exports={init:function(){var e=this;e.bindEvents(),e.checkAddressInfo()},bindEvents:function(){var e=this;$("#j-address-list").on("click",function(t){var s=t.target||t.srcElement,a=$(s),d=a.data("target");if(d){var i={};i.id=a.parents("tr").data("id"),i.areaId=a.parents("tr").data("areaid"),i.target=a,"delete"==d?e.deleteAddress(i):"modify-address"==d?e.modifyAddress(i):"modify-default-address"==d&&e.modifyDefaultAddress(i)}}),$("#j-address-list tr").mouseenter(function(){$(this).addClass("hover")}),$("#j-address-list tr").mouseleave(function(){$(this).removeClass("hover")}),$("#J-add-address .add-address-btn").on("click",function(){$("#J-add-address").hasClass("add-address-active")||$("#J-add-address").addClass("add-address-active"),e.renderProvince()}),$("#J-save-address").click(function(){if(e.checkAddressInfoForSubmit(),0!=e.checkAddressInfoForSubmit()){var t=e.getAddressParams();if($("#J-add-address").hasClass("J-modify-address")){var s="/uc/user/addrmod";t.id=$(this).attr("data-id"),t.is_default=$("#is-default").val()}else var s="/uc/user/addrcrt";$.post(s,t,function(e){if(0==e.errno)location.reload(),window.scrollTo(0,0);else{var t=e.errmsg||e.msg,s=a.alert({width:400,title:"错误提示",customClassName:"ui-alert-uc",content:t,mask:{enable:!0,opacity:.25}});s.center()}},"json")}}),$("#J-cancel-add-address").click(function(){e.cancel(),location.hash=""}),$("#province").change(function(){e.renderCity()}),$("#city").change(function(){e.renderDistrict()}),$("#J-post-link").hover(function(){e.changeSelectPostUrl()})},deleteAddress:function(e){var t="提示",s="确定要删除该地址/收货信息吗？",d=a.confirm({width:400,title:t,content:s,customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){$.ajax({type:"post",dataType:"json",data:{id:e.id},url:"/uc/user/addrdel",success:function(e){if(0==e.errno)location.reload();else{var t=e.errmsg||e.msg,s=a.alert({width:400,title:"错误提示",content:t||"删除失败",customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});s.center()}}})}});d.center()},changeSelectPostUrl:function(){var e="http://opendata.baidu.com/post/s",t="";"省份"!=$("#province option:selected").text()&&(t+=encodeURIComponent($("#province option:selected").text())),"城市"!=$("#city option:selected").text()&&$("#province option:selected").text().indexOf($("#city option:selected").text())<0&&(t+=encodeURIComponent($("#city option:selected").text())),"区域"!=$("#district option:selected").text()&&(t+=encodeURIComponent($("#district option:selected").text())),""!=$("#street").val()&&(t+=encodeURIComponent($("#street").val())),e=e+"?wd="+t+"&rn=20&ie=utf-8",$("#J-post-link").attr("href",e)},checkAddressInfo:function(){var e={empty:/^\s*$/,name:/^[\sA-Za-z0-9\-\u4E00-\u9FA5]{2,15}$/,mobile:/^1\d{10}$/,tel:/^[1-9]\d{6,7}$/,postCode:/^[0-9]\d{5}(?!\d)$/},t={emptyProvince:"您还没有选择您所在的省份",emptyCity:"您还没有选择您所在的城市",emptyDistrict:"您还没有选择您所在的区域",emptyStreet:"您还没有填写街道地址",emptyPostcode:"您还没有填写邮政编码",emptyName:"您还没有填写收货人姓名",emptyPhone:"您还没有填写手机号码",checkStreet:"街道地址不少于5个字，不多于60个字",checkPostcode:"请填写正确邮政编码",checkName:"收货人姓名不少于2个字，不多于15个字",checkPhone:"请正确填写手机号码",checkTel:"请正确填写电话号码"};$("#province").blur(function(){"省份"==$("#province option:selected").text()?($("#area-msg").html(t.emptyProvince),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide")):$("#area-msg").addClass("msg-hide")}),$("#city").blur(function(){"城市"==$("#city option:selected").text()?($("#area-msg").html(t.emptyCity),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide")):$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide")}),$("#district").blur(function(){"区域"==$("#district option:selected").text()?($("#area-msg").html(t.emptyDistrict),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide")):$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide")}),$("#street").blur(function(){var s=$.trim($("#street").val());e.empty.test(s)?($("#street-msg").html(t.emptyStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide")):s.length<5||s.length>60?($("#street-msg").html(t.checkStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide")):$("#street-msg").addClass("msg-hide")}),$("#post-code").blur(function(){var s=$.trim($("#post-code").val());e.empty.test(s)?($("#postcode-msg").html(t.emptyPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide")):e.postCode.test(s)?$("#postcode-msg").addClass("msg-hide"):($("#postcode-msg").html(t.checkPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide"))}),$("#name").blur(function(){var s=$.trim($("#name").val());e.empty.test(s)?($("#name-msg").html(t.emptyName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide")):e.name.test(s)?$("#name-msg").addClass("msg-hide"):($("#name-msg").html(t.checkName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide"))}),$("#phone").blur(function(){var s=$.trim($("#phone").val());e.empty.test(s)?($("#phone-msg").html(t.emptyPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide")):e.mobile.test(s)?$("#phone-msg").addClass("msg-hide"):($("#phone-msg").html(t.checkPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide"))}),$("#tel").blur(function(){var s=$.trim($("#tel").val());e.empty.test(s)||e.tel.test(s)?$("#tel-msg").addClass("msg-hide"):($("#tel-msg").html(t.checkTel),$("#tel-msg").hasClass("msg-hide")&&$("#tel-msg").removeClass("msg-hide"))})},checkAddressInfoForSubmit:function(){var e={empty:/^\s*$/,name:/^[\sA-Za-z0-9\-\u4E00-\u9FA5]{2,15}$/,mobile:/^1\d{10}$/,tel:/^[1-9]\d{6,7}$/,postCode:/^[0-9]\d{5}(?!\d)$/},t={emptyProvince:"您还没有选择您所在的省份",emptyCity:"您还没有选择您所在的城市",emptyDistrict:"您还没有选择您所在的区域",emptyStreet:"您还没有填写街道地址",emptyPostcode:"您还没有填写邮政编码",emptyName:"您还没有填写收货人姓名",emptyPhone:"您还没有填写手机号码",checkStreet:"街道地址不少于5个字，不多于60个字",checkPostcode:"请填写正确邮政编码",checkName:"收货人姓名不少于2个字，不多于15个字",checkPhone:"请正确填写手机号码",checkTel:"请正确填写电话号码"};if("省份"==$("#province option:selected").text())return $("#area-msg").html(t.emptyProvince),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),!1;if($("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide"),"城市"==$("#city option:selected").text())return $("#area-msg").html(t.emptyCity),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),!1;if($("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide"),"区域"==$("#district option:selected").text())return $("#area-msg").html(t.emptyDistrict),$("#area-msg").hasClass("msg-hide")&&$("#area-msg").removeClass("msg-hide"),!1;$("#area-msg").hasClass("msg-hide")||$("#area-msg").addClass("msg-hide");var s=$.trim($("#street").val());if(e.empty.test(s))return $("#street-msg").html(t.emptyStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide"),!1;if(s.length<5||s.length>60)return $("#street-msg").html(t.checkStreet),$("#street-msg").hasClass("msg-hide")&&$("#street-msg").removeClass("msg-hide"),!1;$("#street-msg").addClass("msg-hide");var a=$.trim($("#post-code").val());if(e.empty.test(a))return $("#postcode-msg").html(t.emptyPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide"),!1;if(!e.postCode.test(a))return $("#postcode-msg").html(t.checkPostcode),$("#postcode-msg").hasClass("msg-hide")&&$("#postcode-msg").removeClass("msg-hide"),!1;$("#postcode-msg").addClass("msg-hide");var d=$.trim($("#name").val());if(e.empty.test(d))return $("#name-msg").html(t.emptyName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide"),!1;if(!e.name.test(d))return $("#name-msg").html(t.checkName),$("#name-msg").hasClass("msg-hide")&&$("#name-msg").removeClass("msg-hide"),!1;$("#name-msg").addClass("msg-hide");var i=$.trim($("#phone").val());if(e.empty.test(i))return $("#phone-msg").html(t.emptyPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide"),!1;if(!e.mobile.test(i))return $("#phone-msg").html(t.checkPhone),$("#phone-msg").hasClass("msg-hide")&&$("#phone-msg").removeClass("msg-hide"),!1;$("#phone-msg").addClass("msg-hide");var r=$.trim($("#tel").val());return e.empty.test(r)||e.tel.test(r)?void $("#tel-msg").addClass("msg-hide"):($("#tel-msg").html(t.checkTel),$("#tel-msg").hasClass("msg-hide")&&$("#tel-msg").removeClass("msg-hide"),!1)},getAddressParams:function(){var e={};return e.area_id=0!=$("#district option:selected").val()?$("#district option:selected").val():$("#city option:selected").val(),e.address=$("#province option:selected").text()+" "+$("#city option:selected").text()+" "+$("#district option:selected").text()+" "+$.trim($("#street").val()),e.post_code=$.trim($("#post-code").val()),e.name=$.trim($("#name").val()),e.phone=$.trim($("#phone").val()),e.telephone_district=$.trim($("#tel-district").val()),e.telephone=$.trim($("#tel").val()),e.telephone_ext=$.trim($("#tel-ext").val()),e.csToken=$.trim($("#token").val()),e},modifyAddress:function(e){$.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{action:"modc",id:e.id,area_id:e.areaId},success:function(t){if(0==t.errno){var s=t.data,d=$("#J-add-address");d.hasClass("J-modify-address")||d.addClass("J-modify-address"),d.hasClass("add-address-active")||d.addClass("add-address-active"),$("#J-add-address .w-add-address-form .msg").addClass("msg-hide"),$("#J-save-address").attr("data-id",e.id),d.find(".add-address-form").hasClass("msg-hide")&&d.find(".add-address-form").removeClass("msg-hide");var i,r,o,m=0,n=0,c=0,l="<option value='0'>省份</option>";$.each(s.provs,function(e,t){return l+="<option value='"+t.area_code+"'>"+t.name+"</option>",m+=1,t.area_code==s.curaddr.area_id.substring(0,6)?i=m:void 0}),$("#province").html(l),0!=i?$("#province").find("option").eq(i).attr("selected",!0):($("#province").find("option").eq(0).attr("selected",!0),$("#province").attr("disabled",!0));var h="<option value='0'>城市</option>";$.each(s.cits,function(e){h+="<option value='"+s.cits[e].area_code+"'>"+s.cits[e].name+"</option>",n+=1,s.cits[e].area_code==s.curaddr.area_id.substring(0,9)&&(r=n)}),$("#city").html(h),0!=r?($("#city").find("option").eq(r).attr("selected",!0),$("#city").attr("disabled",!1)):($("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0));var p="<option value='0'>区域</option>";$.each(s.counts,function(e){p+="<option value='"+s.counts[e].area_code+"'>"+s.counts[e].name+"</option>",c+=1,s.counts[e].area_code==s.curaddr.area_id&&(o=c)}),$("#district").html(p),0!=o?($("#district").find("option").eq(o).attr("selected",!0),$("#district").attr("disabled",!1)):($("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)),$("#is-default").val(s.curaddr.is_default),$("#street").val(s.curaddr.address),$("#post-code").val(s.curaddr.post_code),$("#name").val(s.curaddr.name),$("#phone").val(s.curaddr.phone),$("#tel-district").val(s.curaddr.telephone_district),$("#tel").val(s.curaddr.telephone),$("#tel-ext").val(s.curaddr.telephone_ext),location.hash="#J-add-address"}else{var g=t.errmsg||t.msg,u=a.alert({width:400,title:"错误提示",content:g,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});u.center()}}})},modifyDefaultAddress:function(e){e.target.parents("tr").addClass("default-address").siblings().removeClass("default-address");var t={action:"setd",id:e.id};$.post("/uc/user/addrmod",t,function(){location.reload()},"json")},cancel:function(){$("#J-add-address").hasClass("add-address-active")&&($("#J-add-address").removeClass("add-address-active"),$("#J-add-address").find(".add-address-form").addClass("msg-hide")),$("#J-add-address").hasClass("J-modify-address")&&$("#J-add-address").removeClass("J-modify-address"),$("#province").find("option").eq(0).attr("selected",!0),$("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0),$("#street").val(""),$("#post-code").val(""),$("#name").val(""),$("#phone").val(""),$("#tel-district").val(""),$("#tel").val(""),$("#tel-ext").val(""),$("#J-add-address .w-add-address-form .msg").addClass("msg-hide")},renderProvince:function(){$.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{action:"getp"},success:function(e){if(""==e.errno){var t="<option value='0'>省份</option>",s=e.data;$.each(s,function(e){t+="<option value='"+s[e].area_code+"'>"+s[e].name+"</option>"}),$("#province").html(t),$("#province").find("option").eq(0).attr("selected",!0),$("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)}}})},renderCity:function(){var e=$("#province option:selected").val();return 0==e?($("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0),!1):($("#city").attr("disabled",!1),void $.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{pid:e,action:"getcp"},success:function(e){if(""==e.errno){var t="<option value='0'>城市</option>",s=e.data;$.each(s,function(e){t+="<option value='"+s[e].area_code+"'>"+s[e].name+"</option>"}),$("#city").html(t),$("#city").find("option").eq(0).attr("selected",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)}else{var d=e.errmsg||e.msg,i=a.alert({width:400,title:"错误提示",content:d,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});i.center()}}}))},renderDistrict:function(){var e=$("#city option:selected").val();return 0==e?($("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0),!1):($("#district").attr("disabled",!1),void $.ajax({type:"post",url:"/uc/user/addrmod",dataType:"json",data:{cid:e,action:"getcc"},success:function(e){if(""==e.errno){var t="<option value='0'>区域</option>",s=e.data;$.each(s,function(e){t+="<option value='"+s[e].area_code+"'>"+s[e].name+"</option>"}),$("#district").html(t),$("#district").find("option").eq(0).attr("selected",!0)}else{var d=e.errmsg||e.msg,i=a.alert({width:400,title:"错误提示",content:d,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});i.center()}}}))}}});
;define("user:widget/my_account/password/Abstract.js",function(i,t,o){function n(i){this.options=i||{},this.init(i)}{var e=i("common:widget/dep/moye/Dialog.js"),s=i("common:widget/dep/moye/lib.js");i("common:widget/dep/avalon/avalon.js")}n.prototype={constructor:n,init:function(){},prepare:function(){this.initDialog(),this.initSms(),this.initModel()},initDialog:function(){this.main=new e(this.options.dialog).render()},initModel:function(){},initSms:function(){}},$.extend(n.prototype,s.observable),o.exports=n});
;define("user:widget/my_account/password/amount.js",function(s,t,o){function n(s){a.call(this,s)}var e=s("common:widget/util/sms.js"),i=s("common:widget/util/ejson.js"),m=s("common:widget/dep/moye/lib.js"),r=s("common:widget/dep/avalon/avalon.js"),u=window.jQuery,a=s("user:widget/my_account/password/Abstract.js"),c=s("common:widget/dep/moye/Dialog.js");n.prototype={constructor:n,initSms:function(){this.sms=e.create({main:"#sms-btn",type:"setnopass"})},initModel:function(){var s=this,t=this.sms,o=r.define({$id:"modify-amount",smsError:"",smsOk:!1,amountOk:!0,amount:"",$modfyAmount:"",getSmsCode:function(){t.send("/uc/user/securesms",{type:t.type}).then(function(){o.smsError=""},function(s){o.smsError=s.msg})},inputCode:function(){o.smsError=""},validateCode:function(){var s=this.value;return u.trim(this.value)?(o.smsError="",void t.validate("/uc/user/checksmscode",{type:t.type,code:s}).then(function(){o.smsOk=!0,o.smsError=""},function(s){o.smsError=s.msg})):void(o.smsError="验证码为空")},modifyAmount:function(){var s=this.value;o.$modfyAmount=100*parseInt(s,10)},submit:function(t){if(t.preventDefault(),o.smsOk){var n={proType:"setnopass",noPassThreshold:o.$modfyAmount};i.post("/uc/user/setadvancedsecure",{data:n}).then(function(){s.hide(),s.success(),s.fire("amountChange",{noPassThreshold:n.noPassThreshold/100})},function(s){console.info(s.msg)})}}});r.scan(u("#modify-amount")[0])},hide:function(){this.main.hide()},show:function(){this.prepare(),this.main.show()},success:function(){c.alert({title:"提示",width:300,content:'<p class="content-wrap">修改成功</p>',level:400})}},m.inherits(n,a);var d=null,f=function(){return d?d:d=new n({dialog:{title:"修改金额",content:u("#amount-modify-template").html(),level:300,width:450,effect:"zoom",skin:"amount",hideDispose:!0}})};o.exports={Amount:n,getInstance:f}});
;define("user:widget/my_account/password/tel.js",function(t,s,e){function i(t){l.call(this,t)}var o=t("common:widget/util/sms.js"),n=t("common:widget/util/ejson.js"),c=t("common:widget/dep/moye/lib.js"),m=t("common:widget/dep/avalon/avalon.js"),r=t("common:widget/dep/moye/Dialog.js"),d=window.jQuery,l=t("user:widget/my_account/password/Abstract.js");i.prototype={constructor:i,initSms:function(){this.sms=o.create({main:"#tel-btn",type:"setsmsnotify"})},initModel:function(){var t=this,s=this.sms,e=m.define({$id:"modify-tel",smsError:"",smsOk:!1,tel:"",$code:"",getSmsCode:function(){s.send("/uc/user/securesms",{type:s.type}).then(function(){e.smsError=""},function(t){e.smsError=t.msg})},validateCode:function(){var t=d.trim(this.value);e.smsError="",e.$code=t,t&&s.validate("/uc/user/checksmscode",{type:s.type,code:t}).then(function(){e.smsOk=!0},function(t){console.info(t),e.smsError=t.msg})},submit:function(s){if(s.preventDefault(),e.$code||(e.smsError="请输入验证码"),e.smsOk){var i={proType:"setsmsnotify",isSmsNotify:t._isSmsNotify};n.post("/uc/user/setadvancedsecure",{data:i}).then(function(){t.fire("telChange",{ok:!0,smsNotify:!!t._isSmsNotify}),t.hide(),t.success()},function(t){console.info(t)})}return!1}});m.scan(d("#modify-tel")[0]),this.model=e},reset:function(){this.model.smsOk=!1,this.model.smsError="",this.model.tel=""},show:function(t){this.prepare(),this.setOption(t),this.main.show()},setOption:function(t){t&&(t.title&&this.main.setTitle(t.title),this._isSmsNotify=t.isSmsNotify?0:1)},hide:function(){this.main.hide()},success:function(){r.alert({title:"提示",width:300,content:'<p class="content-wrap">修改成功</p>',level:400})}},c.inherits(i,l);var u=null,a=function(){return u?u:u=new i({dialog:{content:d("#tel-modify-template").html(),level:300,width:430,effect:"zoom",skin:"tel",hideDispose:!0}})};e.exports={Tel:i,getInstance:a}});
;define("user:widget/my_account/password/setting.js",function(s,t,o){function n(s){i(s)}function i(s){var t=e.define({$id:"setting",isSmsNotify:s.isSmsNotify,hasPwd:s.hasPwd,smsNotify:{get:function(){return this.isSmsNotify?"关闭":"开启"}},hasPwdTxt:{get:function(){return this.hasPwd?"修改密码":"立即设置"}},noPassThreshold:s.noPassThreshold,modifyAmount:function(){a.show()},toggleSms:function(){d.show({title:t.smsNotify,isSmsNotify:t.isSmsNotify})}});d.on("telChange",function(s){t.isSmsNotify=s.smsNotify}),a.on("amountChange",function(s){t.noPassThreshold=s.noPassThreshold})}{var e=s("common:widget/dep/avalon/avalon.js"),a=(s("common:widget/util/ejson.js"),s("user:widget/my_account/password/amount.js").getInstance()),d=s("user:widget/my_account/password/tel.js").getInstance();window.jQuery}o.exports={enter:n}});
;define("user:widget/my_account/main.js",function(e,n,a){function i(e){{var n=$("#account-tab");new s({main:n[0],panelActiveClass:"n-active",activeClass:"n-active",activeIndex:e.activeTab}).render()}+e.activeTab>0&&n.removeClass("n-no-visible")}function t(n){e("user:widget/my_account/password/setting.js").enter(n)}var s=e("common:widget/dep/moye/Tab.js");a.exports={initTab:i,initPassword:t}});
;define("user:widget/my_account/password/password.js",function(s,o,r){function n(){var s=$("#password-form"),o=a.create("#sms-btn"),r=d.define({$id:"passwordForm",modifyPassword:!1,smsError:"",smsOk:!1,password:"",newPassword:"",passwordExplain:"",newPasswordExplain:"",passwordOk:!1,newPasswordOk:!1,passwordError:!1,success:!1,showForm:!0,focusPassword:function(){r.passwordExplain="请输入6位数字",r.passwordOk=!1},focusNewPassword:function(){r.newPasswordExplain="请重复输入密码",r.newPasswordOk=!1},inputPassword:function(){this.value||(r.passwordExplain="",r.passwordError=!1)},blurPassword:function(){this.value&&this.value.match(/^[0-9]{6}$/)?(r.passwordOk=!0,r.newPasswordError=!1,r.passwordExplain=""):(r.passwordOk=!1,r.passwordError=!0,r.passwordExplain="请输入6位数字")},blurNewPassword:function(){r.newPasswordOk=!1,r.passwordOk&&(this.value!==r.password?r.newPasswordExplain="两次密码不一致":(r.newPasswordOk=!0,r.newPasswordExplain="输入正确"))},getSmsCode:function(){o.send("/uc/user/securesms",{type:"setusersecure"}).then(function(s){r.smsError=s.msg},function(s){r.smsError=s.msg})},validateCode:function(){var s=$.trim(this.value);s&&(r.code=s,r.smsOk=!1,o.validate("/uc/user/checksmscode",{type:"setusersecure",code:s}).then(function(s){return s.result===!1?void(r.smsError=s.msg||"验证码不正确"):(r.smsOk=!0,void(r.smsError=""))},function(s){console.info(s),r.smsError=s.msg}))},submit:function(s){if(s.preventDefault(),!r.code)return void(r.smsError="请输入验证码");if(r.smsOk)if(r.newPasswordOk&&r.passwordOk){var o={pwd:i.encrypt(r.password)};t.post("/uc/user/setusersecure",{data:o}).then(function(){return{ok:!0}},function(s){return console.info(s),{ok:!1}}).always(function(s){r.success=s.ok,r.showForm=!s.ok})}else r.passwordExplain="请输入正确的密码"},modifyPhone:function(s){s.preventDefault(),e.bind()}});d.scan(s[0]),s.removeClass("password-form-hidden")}var e=s("common:widget/ui/passport_bind_phone/passport_bind_phone.js"),a=s("common:widget/util/sms.js"),d=s("common:widget/dep/avalon/avalon.js"),i=s("common:widget/util/encrypt.js"),t=s("common:widget/util/ejson.js");r.exports={init:n}});
;define("user:widget/my_collection/my_collection.js",function(t,e,a){var o=t("common:widget/ui/dialog/dialog.js");a.exports={init:function(){var t=this;t.bindEvents()},bindEvents:function(){var t=this;$("#J-collection-list").click(function(e){var a=e.target||e.srcElement,o=$(a),n=o.data("target");if(n){var i={};o.data("id")&&(i.id=o.data("id")),o.attr("data-status")&&(i.showStatus=o.attr("data-status")),"delete"==n?t.deleteCollection(i):"delete-list"==n&&t.deleteCollectionList(i)}})},deleteCollection:function(t){var e="提示",a="确定要取消该收藏吗？",n=o.confirm({width:400,title:e,content:a,customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){var e={deal_id:t.id,device_type:"PC"};$.get("/uc/user/removefavoritebyid",e,function(t){if(0==t.errno){var e=$("#J-pager").attr("data-p");if(len=$("td.goods-info").length,1==len&&e>1){var a=e-1;location.href=location.pathname+"?p="+a}else location.reload()}else{var n=o.alert({width:400,title:"提示",content:t.msg||"取消成功",customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});n.center()}},"json")}});n.center()},deleteCollectionList:function(t){var e="提示",a="确定要取消所有收藏吗？",n=o.confirm({width:400,title:e,content:a,customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){$.ajax({type:"get",dataType:"json",data:{show_status:t.showStatus,device_type:"PC",removeFavorAllToken:F.context("removeFavorAllToken")},url:"/uc/user/removefavoritebystatus",success:function(t){if(0==t.errno)location.href=location.pathname;else{var e=o.alert({width:400,title:"提示",content:t.msg||"成功取消全部收藏",customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});e.center()}}})}});n.center()}}});
;define("user:widget/order_cinema/list/list.js",function(t,e,a){var n=t("common:widget/ui/dialog/dialog.js"),i=t("common:widget/ui/template/template.js"),o=t("common:widget/ui/passport_bind_phone/passport_bind_phone.js");a.exports={init:function(t){if(t){var e=this;e.bindEvents(),$(t).click(function(t){var a=t.target||t.srcElement,n=$(a),i=n.attr("data-target");if(i){var o={};switch(o.id=n.attr("data-id"),o.target=a,i){case"pay":e.pay(o);break;case"send-msg":e.showSendCodeDialog(o)}}}),$("#j-bind-phone").click(function(){o.bind()})}},bindEvents:function(){$("#j-other-phone").click(function(){var t="新手机号查询",e=i.template,a={},o=e("J-phonechecktpl",a),s=new n({width:588,title:t,content:o,customClassName:"check-phone-dialog",mask:{enable:!0,opacity:.25}});s.center()})},pay:function(t){$.ajax({type:"post",dataType:"json",data:{orderId:t.id},url:"/order/pay",success:function(t){if(0==t.errno)location.href=t.data.payUrl;else{var e=n.alert({width:400,title:"提示",content:t.msg,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});e.center()}}})},showSendCodeDialog:function(t){var e=n.confirm({width:580,title:"提示",content:"兑票信息发送至购买手机中，短信发送限制5次，确认发送吗？",customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){$.ajax({type:"post",dataType:"json",data:{id:t.id},url:"/uc/order/mrsmsg",success:function(t){if(e.dispose(),0==t.errno){var a="提示",i="兑票信息已发送至购买手机中，请注意查收短信",o=n.splash({title:a,content:i,customClassName:"ui-splash-uc",timeout:3e3,mask:{enable:!0,opacity:.25}});o.center()}else{var s=n.alert({width:400,title:"提示",customClassName:"ui-alert-uc",content:t.errmsg||"已超过发送次数限制，请直接查看订单详情",mask:{enable:!0,opacity:.25}});s.center()}}})}});e.center()}}});
;define("user:widget/order_wuliu/detail/detail.js",function(e,d,t){var r=e("common:widget/ui/dialog/dialog.js"),s=e("common:widget/ui/template/template.js");t.exports={init:function(){var e=this;e.addressWrap=$("#J-address-wrap"),e.addressListWrap=$("#J-address-list-wrap"),e.editAddressBtn=$("#J-edit-address"),e.addressForm=e.addressWrap.find(".address-form"),e.deliveryTimeWrap=e.addressWrap.find(".delivery-time-wrap"),e.deliveryTipsWrap=e.addressWrap.find(".delivery-desc-wrap"),e.editDeliveryTimeBtn=e.deliveryTimeWrap.find(".btn-edit"),e.editDeliveryTipsBtn=e.deliveryTipsWrap.find(".btn-edit"),e.saveDeliveryInfoBtn=$("#J-save-deliveryinfo-btn"),e.orderId=e.addressWrap.data("order-id"),e.pageName="order_detail",e.isEditAddress=!1,e.isGetAddressID=!1,e.isPassCheckAddressForm=!0,e.bindEvents()},bindEvents:function(){var e=this;e.copyNo(),e.editAddressBtn.click(function(){e.isEditAddress=!0,e.editDeliveryAddress()}),e.editDeliveryTimeBtn.click(function(){e.deliveryTimeWrap.hasClass("delivery-time-wrap-edit")||e.deliveryTimeWrap.addClass("delivery-time-wrap-edit"),e.isEditAddress||(e.addressWrap.addClass("delivery-info-edit-active"),e.isGetAddressID||e.getDeliveryAddressID())}),e.editDeliveryTipsBtn.click(function(){e.deliveryTipsWrap.hasClass("delivery-desc-wrap-edit")||e.deliveryTipsWrap.addClass("delivery-desc-wrap-edit"),e.isEditAddress||(e.addressWrap.addClass("delivery-info-edit-active"),e.isGetAddressID||e.getDeliveryAddressID())}),e.saveDeliveryInfoBtn.click(function(){e.saveDeliveryInfo()})},bindEventAfterAjax:function(){var e=this;e.addressList=$("#J-address-list-wrap"),e.addressItem=$("#J-address-list-wrap li"),$('[name="addressRadio"]').on("click",function(){if($(this).prop("checked"))var d=$(this).val();$(this).parents("li").addClass("checked").siblings().removeClass("checked"),e.getAddressRadioClickHandler(d)}),e.addressItem.mouseenter(function(){$(this).addClass("hover")}),e.addressItem.mouseleave(function(){$(this).removeClass("hover")}),e.addressItem.click(function(d){var t=d.target||d.srcElement,r=$(t),s=r.data("target");if(s){var a={};a.id=$(this).find('[name="addressRadio"]').val(),a.area_id=$(this).attr("data-areaId"),a.is_default=$(this).attr("data-isDefault"),"delete-address"==s?e.deleteAddress(a.id):"modify-address"==s?($(this).find('[name="addressRadio"]').prop("checked",!0),e.modifyAddress(a)):"modify-default-address"==s&&e.modifyDefaultAddress(a)}})},copyNo:function(){var e="//gss0.bdstatic.com/8r1VfDn-KggZnd_b8IqT0jB-xx1xbK/static/user/widget/order_wuliu/detail/zero_clipboard/ZeroClipboard_9f4401c.swf",d=$("#J-delivery-num");0!==d.length&&d.zclip({path:e,copy:function(){return d.attr("deliverynum")},afterCopy:function(){$(this).css("color","#949494"),$(this).html("已复制")}})},getDeliveryAddressID:function(){var e=this,d={order_id:e.orderId};$.post("/uc/order/OrderAvailableAddress",d,function(d){if(0==d.errno){var t=d.data.orderAddress.id;e.addressWrap.attr("data-id",t),e.isGetAddressID=!0}else{var s=d.errmsg,a=r.alert({width:400,title:"提示",customClassName:"ui-alert-uc",content:s,mask:{enable:!0,opacity:.25}});a.center()}},"json")},editDeliveryAddress:function(){var e=this,d={order_id:e.orderId};$.post("/uc/order/OrderAvailableAddress",d,function(d){if(0==d.errno){var t={orderAddress:d.data.orderAddress,addressList:d.data.userOtherAddresses};e.rendAddressList(t),e.addressWrap.hasClass("address-info-edit-active")||e.addressWrap.addClass("address-info-edit-active"),e.bindEventAfterAjax()}else{var s=d.errmsg,a=r.alert({width:400,title:"提示",customClassName:"ui-alert-uc",content:s,mask:{enable:!0,opacity:.25}});a.center()}},"json")},rendAddressList:function(e){var d=s.template,t=d("J-addresslisttpl",e);this.addressListWrap.html(t)},getAddressRadioClickHandler:function(e){var d=this;if("addNewAddress"==e){if(d.setMaxAddressNum())return;d.resetForm(),d.addressForm.hasClass("hide")&&d.addressForm.removeClass("hide")}else d.addressForm.hasClass("hide")||d.addressForm.addClass("hide")},deleteAddress:function(e){var d="提示",t="确定要删除该地址/收货信息吗？",s=r.confirm({width:400,title:d,content:t,customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){$.ajax({type:"post",dataType:"json",data:{id:e},url:"/uc/user/addrdel",success:function(e){if(0==e.errno)location.reload();else{var d=e.errmsg||e.msg,t=r.alert({width:400,title:"错误提示",content:d||"删除失败",customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});t.center()}}})}});s.center()},modifyAddress:function(e){var d=this;e.action="modc",e.page=d.pageName,$.post("/uc/user/addrmod",e,function(e){if(0==e.errno){var t=e.data;d.addressForm.hasClass("hide")&&d.addressForm.removeClass("hide"),d.addressForm.find("li").filter(".msg").addClass("hide");var s,a,i,o=0,n=0,l=0,c="<option value='0'>省份</option>";$.each(t.provs,function(e,d){return c+="<option value='"+d.area_code+"'>"+d.name+"</option>",o+=1,d.area_code==t.curaddr.area_id.substring(0,6)?s=o:void 0}),$("#province").html(c),0!=s?$("#province").find("option").eq(s).attr("selected",!0):($("#province").find("option").eq(0).attr("selected",!0),$("#province").attr("disabled",!0));var p="<option value='0'>城市</option>";$.each(t.cits,function(e){p+="<option value='"+t.cits[e].area_code+"'>"+t.cits[e].name+"</option>",n+=1,t.cits[e].area_code==t.curaddr.area_id.substring(0,9)&&(a=n)}),$("#city").html(p),0!=a?($("#city").find("option").eq(a).attr("selected",!0),$("#city").attr("disabled",!1)):($("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0));var v="<option value='0'>区域</option>";$.each(t.counts,function(e){v+="<option value='"+t.counts[e].area_code+"'>"+t.counts[e].name+"</option>",l+=1,t.counts[e].area_code==t.curaddr.area_id&&(i=l)}),$("#district").html(v),0!=i?($("#district").find("option").eq(i).attr("selected",!0),$("#district").attr("disabled",!1)):($("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0)),$("#is-default").val(t.curaddr.is_default),$("#street").val(t.curaddr.address),$("#post-code").val(t.curaddr.post_code),$("#name").val(t.curaddr.name),$("#phone").val(t.curaddr.phone),$("#tel-district").val(t.curaddr.telephone_district),$("#tel").val(t.curaddr.telephone),$("#tel-ext").val(t.curaddr.telephone_ext),1==t.curaddr.is_default?$("#j-isDefault").prop("checked",!0):$("#j-isDefault").prop("checked",!1),location.hash="#J-address-form-wrap"}else{var u=e.errmsg,m=r.alert({width:400,title:"提示",customClassName:"ui-alert-uc",content:u,mask:{enable:!0,opacity:.25}});m.center()}},"json")},modifyDefaultAddress:function(e){var d={action:"setd",id:e.id};$.post("/uc/user/addrmod",d,function(){location.reload()},"json")},saveDeliveryInfo:function(){var e=this,d=e.getParams();e.isPassCheckAddressForm&&$.post("/uc/order/orderupdatedelivery",d,function(e){if(0==e.errno)location.hash="",location.reload();else{var d=e.errmsg,t=r.alert({width:400,title:"提示",customClassName:"ui-alert-uc",content:d,mask:{enable:!0,opacity:.25}});t.center()}},"json")},getCheckedAddress:function(){return $('[name="addressRadio"]').filter(function(){return $(this).prop("checked")}).val()},getCheckedDeliveryTime:function(){return $('[name="delivery_time"]').filter(function(){return $(this).prop("checked")}).val()},getParams:function(){var e=this,d={};return d.order_id=e.orderId,e.isEditAddress?(d.id=e.getCheckedAddress(),"addNewAddress"==d.id&&(d.id=""),e.addressForm.hasClass("hide")||(F.checkAddressInfoForSubmit()||(e.isPassCheckAddressForm=!1),d.area_id=0!=$("#district option:selected").val()?$("#district option:selected").val():$("#city option:selected").val(),d.address=$("#province option:selected").text()+" "+$("#city option:selected").text()+" "+$("#district option:selected").text()+" "+$.trim($("#street").val()),d.post_code=$.trim($("#post-code").val()),d.name=$.trim($("#name").val()),d.phone=$.trim($("#phone").val()),d.telephone_district=$.trim($("#tel-district").val()),d.telephone=$.trim($("#tel").val()),d.telephone_ext=$.trim($("#tel-ext").val()),d.is_default=$("#j-isDefault").prop("checked")?"1":"0")):d.id=e.addressWrap.data("id"),d.delivery=e.deliveryTimeWrap.hasClass("delivery-time-wrap-edit")?e.getCheckedDeliveryTime():e.deliveryTimeWrap.data("value"),e.deliveryTipsWrap.hasClass("delivery-desc-wrap-edit")?(d.mark=$('[name="delivery-desc"]').val(),""==d.mark&&(d.mark="--")):d.mark=e.deliveryTipsWrap.data("value"),d},resetForm:function(){$("#province").find("option").eq(0).attr("selected",!0),$("#city").find("option").eq(0).attr("selected",!0),$("#city").attr("disabled",!0),$("#district").find("option").eq(0).attr("selected",!0),$("#district").attr("disabled",!0),$("#street").val(""),$("#post-code").val(""),$("#name").val(""),$("#phone").val(""),$("#tel-district").val(""),$("#tel").val(""),$("#tel-ext").val(""),$("#tel-ext").val(""),$("#j-isDefault").prop("checked",!1),$("#J-add-address .w-add-address-form .msg").addClass("msg-hide")},setMaxAddressNum:function(){var e=$("#J-address-list-wrap li").length-1;if(e>19){var d=r.alert({width:400,title:"提示",customClassName:"ui-alert-uc",content:"您的收货地址数已经达到最大允许的数量",mask:{enable:!0,opacity:.25}});return d.center(),!0}}}});
;define("user:widget/ui/order_operate/order_operate.js",function(e,t,o){var a=e("common:widget/ui/dialog/dialog.js"),n=e("common:widget/ui/template/template.js"),i=e("common:widget/ui/comment/comment.js"),c={DELECT:"/uc/order/removeorder",CANCEL:"/uc/order/logisrefund",PAY:"/order/pay",SENDCODEDIALOG:"/uc/order/noticepage",SENDCODE:"/uc/order/notice",CARTPAY:"/uc/cart/cartorderconfirm/?payWay=rePay&shoppingCartId=",CARTDELETE:"/uc/cart/cartorderremove/?shoppingCartIds="};o.exports={init:function(e){if(e){var t=this;t.phone=" ",t.oldPhone=" ",t.couponDialogTpl="",$(e).click(function(e){var o=e.target||e.srcElement,a=$(o),n=a.attr("data-target");if(n){var i={};switch(i.id=a.attr("data-id"),a.attr("data-deal-id")&&(i.dealId=a.attr("data-deal-id")),a.attr("data-status")&&(i.status=a.attr("data-status")),a.attr("data-page")&&(i.page=a.attr("data-page")),a.attr("data-catg")&&(i.catgIds=a.attr("data-catg")),a.attr("data-stattype")&&(i.statType=a.attr("data-stattype")),a.attr("score")&&(i.score=a.attr("score")),n){case"pay":t.pay(i);break;case"cart-pay":t.pay(i,!0);break;case"delete":t.deleteOrder(i);break;case"cart-delete":t.deleteOrder(i,!0);break;case"send":t.showSendCodeDialog(i);break;case"cancel-logistics":t.cancelLogistics(i);break;case"publish-comment":t.publishComment(i);break;case"publish-comment-star":t.publishCommentwithScore(i);break;case"edit-comment":t.editComment(i)}}}),$(e).mouseover(function(e){var t=e.target||e.srcElement,o=$(t),a=o.attr("data-target");if(a){var n={};if(n.id=o.attr("order-id"),n.dealId=o.attr("deal-id"),n.score=o.attr("score")||0,n.catgIds=o.attr("data-catg"),"publish-comment-star"===a){var i=18*n.score;o.parents(".ugc-star-wrap-uc").find(".ugc-star").width(i)}}})}},pay:function(e,t){t=t||!1;var o="",n={type:"post",dataType:"json",url:c.PAY,success:function(e){if(0==e.errno)location.href=e.data.payUrl;else{var t="default",o="object"===$.type(e.msg)?e.msg[t]:e.msg,n=a.alert({width:400,title:"提示",content:o,customClassName:"ui-alert-uc",mask:{enable:!0,opacity:.25}});n.center()}}};t?(o=location.host,n.type="GET",n.url=c.CARTPAY+e.id):n.data={orderId:e.id},$.ajax(n)},showSendCodeDialog:function(e){function t(t){$.ajax({type:"get",dataType:"json",data:{order_id:e.id},url:c.SENDCODEDIALOG,success:function(e){if(console.info(e),""!==e){for(var a=["糯米券","商家消费码"],n=a[1*t],i=e.coupon.length,c=0,s=1;c<e.coupon.length;c++)1*e.coupon[c].is_stat_code===1&&1*e.coupon[c].can_send_coupon===1&&(e.coupon[c].coupon_code=1===i?a[t]:a[t]+"["+s+"]",s++),e.coupon[c].last_notice_mobile=e.coupon[c].last_notice_mobile.replace(/^(\d{3}).*(\d{4})$/g,"$1****$2");var r={title:e.short_title,expireTime:e.expire_time,phone:e.mask_mobile,sendPhone:e.mobile,couponList:e.coupon,typeTitle:n};o.renderTpl(r,"获取"+n),o.phone=e.mobile,o.oldPhone=e.mask_mobile,$("#J-send-code").on("click",function(){o.sendCode(e.order_id,t,e.deal_id)}),o.checkedNum=0,$("#J-coupons input[type='checkbox']").on("change",function(){1==$(this).prop("checked")?($(this).parents("li").addClass("J-coupon-checked").removeClass("J-coupon-use"),o.checkedNum+=1,5==o.checkedNum&&o.setDisabledforCouponList()):$(this).parents("li").hasClass("J-coupon-checked")&&($(this).parents("li").removeClass("J-coupon-checked").addClass("J-coupon-use"),o.checkedNum-=1,o.checkedNum<5&&o.cancelDisabledforCouponList())})}}})}var o=this,n=e.statType;if(1*n===1){a.confirm({width:350,title:"获取商家消费码",customClassName:"send-code-dialog",content:'<p class="warning-text">一旦获取商家消费码，该券码消费状态将变更为“已使用”（该状态变更不影响正常消费）且不支持退款。如有问题，请联系客服：400-9216-666</p>',onok:function(){this.hide(),t(n)}})}else t(n)},deleteOrder:function(e,t){var o="提示",n="确定要删除该订单吗？";t=t||!1;var i=a.confirm({width:400,title:o,content:n,customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){var o={order_id:e.id},a=c.DELECT;t&&(a=c.CARTDELETE+e.id,o=null),$.get(a,o,function(t){if(0==t.errno)if("detail"==e.page)location.href="/uc/order/order?status=all";else{var o=$("#J-pager").attr("data-p"),a=$("#J-pager").attr("data-status"),n=$("td.goods-info").length;if(1==n&&o>1){var i=o-1;location.href=location.pathname+"?status="+a+"&p="+i}else location.reload()}},"json")}});i.center()},cancelLogistics:function(e){var t="提示",o="确定要取消该订单吗？",n=a.confirm({width:400,content:o,customClassName:"ui-confirm-uc",mask:{enable:!0,opacity:.25},onok:function(){var o={order_id:e.id};$.get(c.CANCEL,o,function(e){if(0==e.errno){n.dispose();var o=a.splash({content:"订单已取消，退款金额原路退款，预计2-5个工作日完成，请耐心等待！",width:640,customClassName:"ui-splash-tips",timeout:5e3,mask:{enable:!0,opacity:.25}});o.center(),setTimeout(function(){location.reload()},5e3)}else{var i=a.alert({title:t,content:e.msg,width:500,customClassName:"ui-alert-uc"});i.center()}},"json")}});n.center()},publishComment:function(e){i.init({orderId:e.id,dealId:e.dealId,catg_ids:e.catgIds,score:0})},publishCommentwithScore:function(e){i.init({orderId:e.id,dealId:e.dealId,catg_ids:e.catgIds,score:e.score})},editComment:function(e){i.init({orderId:e.id,dealId:e.dealId,catg_ids:e.catgIds})},renderTpl:function(e,t){var o=this,i=t,c=n.template,s=c("J-coupontpl",e);o.couponDialogTpl=new a({width:555,title:i,content:s,customClassName:"send-code-dialog",mask:{enable:!0,opacity:.25}}),o.couponDialogTpl.center()},modifyPhoneNo:function(){if($("#J-change-phone").val()==this.oldPhone)$("#J-phone-wrap .warning").html("");else{if(!this.checkPhoneNo($("#J-change-phone").val()))return $("#J-phone-wrap .warning").html("请输入正确的11位手机号"),!1;$("#J-phone-wrap .warning").html("")}},checkCodeNo:function(){if($("#J-change-phone").val()==this.oldPhone)$("#J-phone-wrap .warning").html("");else{if(!this.checkPhoneNo($("#J-change-phone").val()))return $("#J-phone-wrap .warning").html("请输入正确的11位手机号"),!1;$("#J-phone-wrap .warning").html("")}},checkPhoneNo:function(e){var t=e.toString(),o=/^1\d{2,10}$/i;return 11==t.length&&o.test(t)?!0:!1},sendCode:function(e,t,o){var a=$.trim($("#J-change-phone").val()),n="";a==this.oldPhone&&(a=this.phone),$("#J-coupons li").each(function(){if($(this).hasClass("J-coupon-checked")){if(0==$(this).find("input").is(":checked"))return;n=""==n?$(this).attr("coupon-codeid"):n+","+$(this).attr("coupon-codeid")}});var i=c.SENDCODE,s={order_id:e,deal_id:o,coupon:n,mobile:a,is_stat_code:t};return""==s.coupon?void $("#J-phone-wrap .warning").html("请选择要发送的糯米券"):($("#J-phone-wrap .warning").html(""),this.checkPhoneNo(s.mobile)?($("#J-phone-wrap .warning").html(""),void this.sendRequest(i,s)):void $("#J-phone-wrap .warning").html("请输入正确的11位手机号"))},sendRequest:function(e,t){var o=this;$.get(e,t,function(e){if(0==e.errno){o.couponDialogTpl.dispose();var t="提示",n="<p>百度糯米券已发送到您手机，短信可能有所延迟，请耐心等待，3秒后页面自动刷新</p>",i=a.splash({title:t,content:n,width:600,customClassName:"ui-splash-tips",timeout:3e3,mask:{enable:!0,opacity:.25}});i.center(),window.setTimeout(function(){window.location.reload()},3002)}else{var c=e.msg;(1515312==e.errno||1201515312==e.errno)&&(c="发送过于频繁"),o.couponDialogTpl.dispose();var s=a.alert({title:t,content:c,width:600,customClassName:"ui-alert-uc"});s.center()}},"json")},setDisabledforCouponList:function(){$("#J-coupons li").each(function(){$(this).hasClass("J-coupon-use")&&($(this).find("input").prop("disabled",!0),$(this).addClass("coupon-gray"))})},cancelDisabledforCouponList:function(){$("#J-coupons li").each(function(){$(this).hasClass("J-coupon-use")&&$(this).hasClass("coupon-gray")&&($(this).find("input").prop("disabled",!1),$(this).removeClass("coupon-gray"))})}}});
;define("user:widget/ui/qianbao/sync_bduss.js",function(n,i,s){var t=function(n){null!=n&&(n.client="pc",$.ajax({url:"https://passport.baidu.com/v3/login/api/sync/",data:n,dataType:"jsonp",success:function(){},error:function(){}}))};s.exports={init:t}});